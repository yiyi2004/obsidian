记住结论就好了，过程可以不要看。

目的：部署密码系统的时候，你要避开哪些坑。重点的结论，多次的强调。

选择密文的问题。
**
## Hash 函数

![[Pasted image 20220706191803.png]]

消息的长度是有限制的，填充的问题。

![[Pasted image 20220706191838.png]]

1. 单向性
2. 抗二次原像，若碰撞性。
3. H 是不定的。

![[Pasted image 20220706192053.png]]

搞不明白，我好难受。

![[Pasted image 20220706192232.png]]

- [ ] 生日攻击

![[Pasted image 20220706192301.png]]

![[Pasted image 20220706192430.png]]

![[Pasted image 20220706192559.png]]  
![[Pasted image 20220706192618.png]]

- hash 值空间

![[Pasted image 20220706192707.png]]

- IV 是常数

![[Pasted image 20220706192741.png]]

所以设计抗碰撞的 hash 函数就可以了。

![[Pasted image 20220706192844.png]]

![[Pasted image 20220706192908.png]]

- DM 结构
- E 可以堪称一个很大的代换表

![[Pasted image 20220706193055.png]]

![[Pasted image 20220706193425.png]]

- [ ] SHA-256

部署的时候：  
google：你坏事做尽！

用两种 hash 函数

## SM3

![[Pasted image 20220706193702.png]]

- [ ] 和 SHA-256 去比较一下

### 可厉害的土豆

![[Pasted image 20220706193855.png]]

![[Pasted image 20220706194006.png]]

![[Pasted image 20220706205138.png]]

- 和 SHA1 是非常相似的

![[Pasted image 20220706205755.png]]  
![[Pasted image 20220706205955.png]]  
![[Pasted image 20220706210329.png]]  
![[Pasted image 20220706210404.png]]  
![[Pasted image 20220706210815.png]]  
![[Pasted image 20220706210844.png]]

- ABCDEFGH 中一开始存储的是一个 IV 值。

![[Pasted image 20220706211432.png]]  
![[Pasted image 20220706211549.png]]  
![[Pasted image 20220706211656.png]]

### 上课的内容

![[Pasted image 20220706211856.png]]

## 消息认证码

![[Pasted image 20220706212108.png]]

算法是硬件实现的

![[Pasted image 20220706212703.png]]

- [ ] 什么是存在性伪造

![[Pasted image 20220707092140.png]]

![[Pasted image 20220707092456.png]]

穷举搜索而不是生日攻击

![[Pasted image 20220707092557.png]]

消息认证码不一定是可逆的，PRF

![[Pasted image 20220707092730.png]]

![[Pasted image 20220707092811.png]]

- [ ] 截断的技术要考虑仍然是可忽略的

![[Pasted image 20220707092842.png]]

![[Pasted image 20220707092924.png]]  
![[Pasted image 20220707093001.png]]  
![[Pasted image 20220707093118.png]]

![[Pasted image 20220707093323.png]]

- 因为 PRP 是一一映射，而且是可逆的。
- 一般性的攻击。

- [ ] 生日攻击

![[Pasted image 20220707093437.png]]

- [ ] 伪造攻击

所以可以增加随机数的部分

![[Pasted image 20220707093557.png]]

![[Pasted image 20220707093637.png]]

![[Pasted image 20220707093711.png]]

### CMAC

![[Pasted image 20220707093736.png]]  
![[Pasted image 20220707093807.png]]

- $R_b$ 是分组长度

![[Pasted image 20220707093911.png]]

1. 是整数倍和不是整数倍分开了。

![[Pasted image 20220707094035.png]]

学习才是生活的常态，你有没有更好的选择呢？

两个子程序

![[Pasted image 20220707100038.png]]

![[Pasted image 20220707100110.png]]

1. 检测不出来
2. 检测出来的次数

![[Pasted image 20220707100347.png]]

- [ ] **作业哦**

![[Pasted image 20220707100427.png]]

![[Pasted image 20220707101637.png]]  
![[Pasted image 20220707101656.png]]  
![[Pasted image 20220707101814.png]]

- 实现两套算法，增加了电路的面积。

![[Pasted image 20220707102048.png]]

- [ ] 什么是链接变量。

![[Pasted image 20220707102205.png]]

## 认证加密

![[Pasted image 20220707102638.png]]

选择密文攻击：控制解密机

IV + nounce

- [ ] 为什么挑战的目标密文可以是不相同的东西？我的血压真的上来了。

![[Pasted image 20220707103946.png]]

- [ ] 防止密文被修改

![[Pasted image 20220707104115.png]]

![[Pasted image 20220707104349.png]]

- [ ] 什么不能一样，什么意思啊？

![[Pasted image 20220707131111.png]]

CPA 挑战

![[Pasted image 20220707131226.png]]

![[Pasted image 20220707131258.png]]

![[Pasted image 20220707131307.png]]

cl 破坏密文完整性的优势。

![[Pasted image 20220707131347.png]]

![[Pasted image 20220707131355.png]]

![[Pasted image 20220707131409.png]]

![[Pasted image 20220707131506.png]]

- [ ] 比较好的都成为了一些标准

![[Pasted image 20220707131558.png]]

- [ ] 认证加密

associated data 仅仅保证完整性。  
![[Pasted image 20220707131746.png]]

![[Pasted image 20220707131801.png]]

1. 不抵抗重放空寂
2. 不抵抗测信道

![[Pasted image 20220707131845.png]]

![[Pasted image 20220707131943.png]]

![[Pasted image 20220707132339.png]]

![[Pasted image 20220707132459.png]]

![[Pasted image 20220707132509.png]]

- [ ] 带入公式就可以了。
- [ ] 满足 CCA 模式

1. 以后都要用**认证加密**的形式
2. 认证 CMAC、HMAC
3. 密钥周期的问题

## 公钥密码

![[Pasted image 20220707132706.png]]

![[Pasted image 20220707132740.png]]

![[Pasted image 20220707132823.png]]

![[Pasted image 20220707132840.png]]

![[Pasted image 20220707132859.png]]

![[Pasted image 20220707132911.png]]

![[Pasted image 20220707132953.png]]

- [ ] 陷门信息

认证加密 + 密码模块 (AES)

![[Pasted image 20220707133236.png]]

![[Pasted image 20220707133400.png]]

TDF：单向陷门函数。

![[Pasted image 20220707133505.png]]

可以抗选择密文攻击，要仔细学习密码学内容。

![[Pasted image 20220707133558.png]]

- 不要用单向陷门函数直接对消息进行加密。

![[Pasted image 20220707133700.png]]

如果生成的密钥太长，直接截断不就可以喽。

![[Pasted image 20220707133907.png]]

我懂你是什么意思哦。

![[Pasted image 20220707133943.png]]

![[Pasted image 20220707134001.png]]

- [ ] 什么是规约，规约到 e 次方根问题。

![[Pasted image 20220707134044.png]]

- [ ] 要对基本的 hash 函数进行改造
- [ ] DH

![[Pasted image 20220707134256.png]]

![[Pasted image 20220707134323.png]]

- [ ] 我裂开了，听不懂了
- [ ] 离散对数问题

![[Pasted image 20220707134345.png]]

- [ ] 是一个不比离散对数问题难的问题

![[Pasted image 20220707134422.png]]

![[Pasted image 20220707134551.png]]

- [ ] 什么是 RSA 模长度，你们真的就这样讲课嘛？
- [ ] 真的太让人窒息了，我都看不明白了。

![[Pasted image 20220707134705.png]]

量子计算对公钥密码体制的冲击是很大的。

后量子算法

![[Pasted image 20220707134813.png]]
