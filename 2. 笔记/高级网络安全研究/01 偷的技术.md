# Hook
- 钩子类型(5种)
- 定义、安装、卸载钩子函数

# 高级 “偷”

## Side-Channel Attacks
- The security of computer systems fundamentally relies on **memory isolation.**
- Meltdown exploits side effects of out-of-order execution on modern processors to read arbitrary **kernel-memory** locations including personal data and passwords.

![[Pasted image 20221102111035.png]]

- Out-of-order execution is implemented within the execution engine

### Cache Attack
- Cache side-channel attacks exploit timing differences that are introduced by the caches. Different cache attack techniques have been proposed and demonstrated in the past, including **Evict+Time** [55], **Prime+Probe** [55, 56], and **Flush+Reload** [63]. Flush+Reload attacks work on a single cache line granularity

- Evict＋Reload 计算机研究与发展：访问驱动下的Cache 侧信道攻击研究综述
- Prime+Probe https://www.cnblogs.com/sctb/p/12050547.html
- Flush+Reload https://www.cnblogs.com/sctb/p/12050547.html
- 3种 Cache侧信道攻击的攻击范围比较
![[Pasted image 20221102111933.png]]
## Dolphin Attack


## Light Commands

## Lamphone

## Sensor Fusion

# Meltdown

# Meltdown 与 Spectre
## 1. 漏洞原理
- 乱序执行(out-of-order exection) 和预测执行(speculative execution)。其实还是有点用的。
- retirement-一条指令退休只有当它的执行的结果真正被提交并对系统可见时才会发生
- 如果在乱序执行中，指令并没有真正执行完成而只是加载到缓存中（下文会提）是不会执行安全检查的。而此时由于乱序执行而被提前执行的指令会被处理器丢弃，但由于乱序执行的指令对缓存的操作在**这些指令被丢弃时不会被重置**。正是安全检查与乱序执行的空窗期才会让Meltdown有机可乘。
- 与乱序执行类似，预测执行对处理器缓存的操作会被保留。这种机制从宏观上看似乎没什么问题，但由于处理器的缓存（cache）机制，那些被预测执行或乱序执行的指令会被先加载到缓存中，但在处理器恢复状态时并不会恢复处理器缓存的内容。而最新的研究表明攻击者可以利用缓存进行侧信道攻击，**而Meltdown与Spectre从本质上来看属于利用处理器的乱序执行或预测执行漏洞进行的缓存侧信道攻击。**
- 介绍一下 **Flush+Reload**，也是下文exploit中利用的方法。假设攻击者和目标程序共享物理内存（也可以是云中不同虚拟机共享内存），攻击者可以反复利用处理器指令将监控的内存块（某些地址）从缓存中驱逐出去，然后在等待目标程序访问共享内存（Flush阶段）。然后攻击者重新加载监控的内存块并测量读取时间(Reload阶段)，如果该内存块被目标程序访问过，其对应的内存会被导入到处理器缓存中，则攻击者对该内存的访问时间将会较短。通过测量加载时间的长短，攻击者可以清楚地知道该内存块是否被目标程序 读取过。
- Meltdown与Spectre利用这种侧信道可以进行越权内存访问，**甚至读取整个内核的内存数据**。

## Reference
- [(82条消息) 一步一步理解CPU芯片漏洞：Meltdown与Spectre_小白的小肉丸的博客-CSDN博客](https://blog.csdn.net/weixin_43171033/article/details/116449103?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166735981616800182763764%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166735981616800182763764&biz_id=0&spm=1018.2226.3001.4187)
- [(83条消息) Meltdown & Spectre原理简要梳理_会打代码的扫地王大爷的博客-CSDN博客_meltdown和spectre](https://blog.csdn.net/wlmnzf/article/details/79319509?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166735981616800182763764%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166735981616800182763764&biz_id=0&spm=1018.2226.3001.4187)

