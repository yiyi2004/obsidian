- [[../07 点赞|07 点赞]]

1. insrCnt
	1. WithContext
	2. Clauses(OnConflict{Doupdates: clasuse.Assignments{map[string]any}})
	3. Create 如果不冲突，就创建一个。
2. gorm.Expr 操作 —— "`read_cnt` + 1"
3. 创建联合唯一索引 —— 文章 - 文章 id
4. Redis HIncrBy 能够保证，read_cnt 不存在，先设置为 0，然后自增 1
5. Lua 脚本执行 read_cnt 自增
6. 检查 — 做某事，容易出现并发问题，所以要用 Redis Lua 脚本去剞劂
7. cnt_key: read_cnt like_cnt or collect_cnt
8. delta +1 or -1
9. 软删除
