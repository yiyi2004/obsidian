- [[../05 接入日志模块和配置模块|05 接入日志模块和配置模块]]
- [[../05 微信扫码登录(未完成)|05 微信扫码登录(未完成)]]
1. 技术选型
	1. 功能性
	2. 社区和支持度
	3. 非功能性：扩展性、性能
2. 通过配置中心 + 随机数 ---> 控制流量限流什么的
3. etcdctl --endpoints=xxx put /webook "$(<dev.yaml)"
4. viper 只能告诉你配置文件变了，但是不会告诉你哪些变了
5. uber/atomic
6. 灰度发布
7. 初始化只针对想 比如 db 要用 unsafe.Pointer()
	1. 然后使用 atomic.StorePointer
8. Go-Admain 是不错的实现
9. 保持依赖注入的风格
10. stream 读完就没了，因此你要重新写进去，但是会引起复制，是一个很消耗 CPU 的操作。 ctx.Request.Body
11. 小心并发安全的问题，所以要用原子操作，使用 uber 的 atomic 更加好用
12. 动态监听变更，监听配置项。在初始化的过程中监听
13. 保证短信发送成功、设计的核心
	1. 收到短信请求，立刻存储到数据库中
	2. 立刻尝试发送
	3. 发送失败，异步补偿机制，定时烧苗数据库，发现没有发送，补发
14. MQ 问题是不可追溯的
15. MQ + MySQL
16. 高大上 消息队列 但是有延迟
17. 可观测性
	1. 日志 + tracing + metrics + 响应时间
	2. 日志 + 可观测性 + ELK 改善性能和可用性 + 快速发现问题
18. 利用泛型操作，userClaims 取出来
19. 微信扫码登录
	1. 第一步 qrconnect
		1. appid
		2. rediect_uri
		3. response_type 固定为 code
		4. scope snsapi_login
		5. state 一个随机数
	2. 第二步 access_token：回来的时候带上一个临时授权码 code，你用 code 取微信换取一个 access_token
	3. 后台处理 rediect_uri 中带回来的 code，找微信换取真正长时间的有效授权码
20. 两个接口
	1. 构造请求微信的 URL
	2. 处理微信跳转回来的请求
21. state 是 uuid.New
22. 从微信拿回来的字段
	1. access_token 访问微信，获取用户数据
	2. expires_in: access_token 的过期时间
	3. refresh_token：actoken 过期之后，用 rt 去找微信换一个新的 act
	4. open_id：应用下唯一 ID
	5. union_id：公司

---

- [[../06 文本存储和发帖功能|06 文本存储和发帖功能]]

1. gorm 忽略零值变化
2. 一个领域中的实体，可能是其他领域内的一个字段
3. save or create 最好返回一个 id
4. gomock 的使用 [[../../../../Coding/Go/第三方库/gomock|gomock]]
5. 制作库和线上库
6. service 层面不适合开事务
7. repository 上开事务
8. 通过重试机制去实现
9. 指数退避类的重试
10. Canal 监听 binlog
11. 分布式事务的 AT 模式，生成相反的 update 的，恢复数据。
12. **golang 分布式事务**  
13. 启动 goroutine 修复
14. **使用 canal status**
15. TCC 两个微服务
16. DAO 层面上开启事务，数据库事务，2~3 张表是有关联关系的。
17. **事务传播机制依赖 thread local 机制，没有 API 操作当前的 goroutine**
18. 修改文章 —— 对接大数据接口
19. 状态流转—— 分析系统状态
20. 国企需要准备什么呢
21. 两种方案
	1. 在 service 层面上区分是 reader repository 还是 writer repository
	2. 先更新数据库，然后再删除缓存
22. 查文章库和查作者库可以并发进行，可以开一个 goroutine 去发给 kafka 信号
23. "github.com/bwmarrin/snowflake"  
24. "go.mongodb.org/mongo-driver/bson"  
25. "go.mongodb.org/mongo-driver/mongo"  
26. "go.mongodb.org/mongo-driver/mongo/options"
27. snowflake [[../../../../Coding/Go/第三方库/snowflake|snowflake]]
28. **发表文章的代码还需要重新看一遍嚄**

---
