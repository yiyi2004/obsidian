# 流密码
![[Pasted image 20220705191054.png]]

统计特性

![[Pasted image 20220705131129.png]]

统计测试

![[Pasted image 20220705131452.png]]
![[Pasted image 20220705131532.png]]

	判断有没有泄露信息。
- [ ] 优势：猜对 - 猜错，给定相同的输入。

![[Pasted image 20220705131718.png]]

如果伪随机数生成器是安全的，那么流密码算法也是安全的。

![[Pasted image 20220705131944.png]]

- [ ] 和伪随机数生成器安全性之间的关系。
- [ ] G 是伪随机数生成器，如果 G 是安全的。。。。

![[Pasted image 20220705132310.png]]

- [ ] IV 是初始向量
- [ ] Estream 推荐使用流密码

HC-128 借鉴 RC4

选择密文攻击：

- [ ] oracle 是什么意思。

![[Pasted image 20220705132849.png]]

- [ ] 选择密文攻击，我真的服了，我怎么感觉自己听不懂呢？
- [ ] 什么是 SS 安全
- [ ] 增加 MAC 值

对于这种选择 IV 的存在**选择密文攻击**。

![[Pasted image 20220705133025.png]]

**抗选择密文攻击：配合一定的认证技术、流密码要加上 MAC。**

IV 值的使用 会有一定的周期，修改 k。

$c'$  是伪造的，加 MAC 可以识别消息是否是伪造的。oracle，可以根据密文进行解密。

1. IV
2. 选择密文攻击

# 祖冲之流密码算法 ZUC
![[Pasted image 20220705133316.png]]

![[Pasted image 20220705193227.png]]

![[Pasted image 20220705133457.png]]


![[Pasted image 20220705193323.png]]

![[Pasted image 20220705193343.png]]

![[Pasted image 20220705193423.png]]

状态更新，第一次不输出，第二次输出。


![[Pasted image 20220705193735.png]]

1. 中间是比特重组。

![[Pasted image 20220705194022.png]]

![[Pasted image 20220705194134.png]]

![[Pasted image 20220705194210.png]]

32bit，4 个 byte，其实是能听懂的。
![[Pasted image 20220705194406.png]]
![[Pasted image 20220705194415.png]]

![[Pasted image 20220705194434.png]]
![[Pasted image 20220705194641.png]]

$s_{16}$ 的设置是不一样的。

![[Pasted image 20220705195022.png]]

模乘和模加是否有更加快速的运算方法。

# 分组密码
![[Pasted image 20220705195555.png]]

如何安全的使用。

区别：分组填充技术
![[Pasted image 20220705195653.png]]
![[Pasted image 20220705195805.png]]

伪随机置换是特殊的 PRF。

多项式时间的算法。
![[Pasted image 20220705195914.png]]
![[Pasted image 20220705200043.png]]
![[Pasted image 20220705200129.png]]

大的函数空间，还是小的函数空间？

![[Pasted image 20220705200205.png]]

![[Pasted image 20220705200226.png]]

![[Pasted image 20220705200348.png]]

	加解密相似，可逆的。


![[Pasted image 20220705200430.png]]


如果两轮呢？
- 两轮有直接的相反关系

![[Pasted image 20220705200840.png]]

![[Pasted image 20220705200945.png]]

![[Pasted image 20220705201046.png]]

![[Pasted image 20220705201134.png]]

没有考虑消息 m 是什么。流模式：最后的只需要截一段，不需要再进行填充了。

![[Pasted image 20220705201430.png]]
![[Pasted image 20220705201508.png]]

![[Pasted image 20220705201546.png]]
![[Pasted image 20220705201826.png]]

我有的时候都开始怀疑自己是不是啥子了。

一个是安全的，另一个不一定是安全的。

为什么要折磨自己，报两门课。

![[Pasted image 20220705211850.png]]

![[Pasted image 20220705211936.png]]
1. 算法的扩张——通常不使用

为什么不用
1. 不一定有相应的算法
2. 电路的损耗，多集成几个算法实际上损耗是比较大的

nounce 随机数
![[Pasted image 20220705212246.png]]

要有一些随机的东西。nonce 不传，减少带宽了。

![[Pasted image 20220705212545.png]]

![[Pasted image 20220705212733.png]]

1. 如果加密的块数过多，那么安全性也就没有办法保证了。
- [ ] q 消息个数没有看懂

**如果长期不去更换，那么会存在一个安全风险的。**

![[Pasted image 20220705213552.png]]

![[Pasted image 20220705213638.png]]

![[Pasted image 20220705213655.png]]

![[Pasted image 20220705213732.png]]

- [ ] counter 模式中是不需要用到解密模式的，所以用 PRF 就可以。
	- [ ] 密码学

选择明文下是安全的。

![[Pasted image 20220705214004.png]]


![[Pasted image 20220705214117.png]]

![[Pasted image 20220705214156.png]]

完全并行的一种算法

![[Pasted image 20220705214301.png]]

密文的长度和明文的长度一致，但是 IV 可能扩张。
![[Pasted image 20220705214409.png]]

密文偷窃

![[Pasted image 20220705214513.png]]

CBC 模式下原来是要求填充的，但是通过这种方式可以保持明文和密文长度一致。
1. 加密过程听明白了。
2. 解密的过程也听懂了，小花招 hhh，减少密文扩张。数学真是有趣啊。

![[Pasted image 20220705215054.png]]

![[Pasted image 20220705215136.png]]

随机加密安全性，关系到加密多少 blocks 要替换密钥的。

![[Pasted image 20220705215305.png]]

![[Pasted image 20220705215329.png]]

分组密码研究是最广泛的，技术比较成熟，攻击也比较成熟。

![[Pasted image 20220705215508.png]]

分组密码吞吐率不太高哦。

![[Pasted image 20220705215545.png]]

- [ ] 这几个攻击方式需要仔细的学习一下。

![[Pasted image 20220705215757.png]]

![[Pasted image 20220705215906.png]]

- [ ] 随机和不可预测是不同的概念哦，


![[Pasted image 20220705220053.png]]

![[Pasted image 20220705220118.png]]

- [ ] 错误传播问题

**上面的重点是理解祖冲之算法**

1. 长消息不建议使用 ECB
2. IV 要有一定的长度，不可预测性、唯一性，要满足性质
3. 满足 CPA 安全，只有选择明文攻击满足。没有满足选择密文攻击。
4. 选择密文攻击，对 c 进行串改，能得到优势，能够攻击成功，能够破译。
5. CPA 安全不一定能够满足机密性。
6. 怎么保证机密性？
	1. 不能对密文进行串改，消息认证的技术 MAC 配合加密，一起保证密文不被串改，别人不能从里面获取任何信息。
	2. ctr 是 CPA 安全不是 CCA 安全
7. 密钥的周期
	1. AES、DES、count cbc 模式安全结论，加密到多少块要更换密钥。
	2. **SM4 对于密钥的周期应该是什么样子的。其实就是一个简单的计算。**

# SM4
正式公开的密码算法的标准。
1. 32 次迭代
2. 反序变换

无线的标准。

![[Pasted image 20220705221147.png]]

- [ ] **加解密相似**

![[Pasted image 20220705230455.png]]
![[Pasted image 20220705230531.png]]

![[Pasted image 20220706083958.png]]

![[Pasted image 20220706084116.png]]![[Pasted image 20220706084116 1.png]]
![[Pasted image 20220706084139.png]]

![[Pasted image 20220706085143.png]]

- s 盒

![[Pasted image 20220706085203.png]]

- CK 是一个常数

## 可厉害的土豆
![[Pasted image 20220706092703.png]]
![[Pasted image 20220706092823.png]]
![[Pasted image 20220706093304.png]]

![[Pasted image 20220706093620.png]]
![[Pasted image 20220706093548.png]]

![[Pasted image 20220706093646.png]]

![[Pasted image 20220706093722.png]]

- 非线性变换

![[Pasted image 20220706093757.png]]

![[Pasted image 20220706093848.png]]

### 密钥的生成过程
![[Pasted image 20220706094438.png]]

![[Pasted image 20220706094458.png]]

### 举例
![[Pasted image 20220706094634.png]]





