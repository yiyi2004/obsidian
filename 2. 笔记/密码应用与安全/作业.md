# 第二讲
![[Pasted image 20220707140526.png]]

$ab \ mod(2^{31}-1)$ 快速实现方法：

其中 $b$ 可以写成：
$$
	b = 2^i + 2^j + 2^k
$$
则
$$
ab\ mod(2^{31}-1) = (a<<<_{31}i) + (a<<<_{31}j) + (a<<<_{31}k)mod(2^{31}-1)
$$
其中：$<<<_{31}$ 表示 31 比特左循环移位运算。

$a+b \ mod(2^{31}-1)$ 实现可以通过以下两步计算实现：
1. $c = a + b$
2. $c = (c \ \& \ 0 \mathrm{x}7\mathrm{FFFFFFF})+ (c >> 31)$

![[Pasted image 20220707142332.png]]

**2） 平时作业：给出SM4部署时密钥更新的周期（假设SM4 安全的PRP(PRF), 相应CBC模式和CTR加密时，给出密钥更新周期）**

SM4 的密钥长度是 128 bit

CBC 模式下：$qL < 2^{48}$
CTR 模式下：$qL^{\frac{1}{2}}<2^{48}$

![[Pasted image 20220707142923.png]]

![[Pasted image 20220707143338.png]]

根据公式：
$$
	Tlen \ge lg(MaxInvalids/Risk)
$$
计算得：
$$
	Tlen \ge lg(2^{10} / 2^{-20})\\
$$
$$
	Tlen \ge 30	

$$

所以 Tlen 的长度至少是 30。





![[Pasted image 20220713161009.png]]

行，不改变数据值，只改变位置，也就是 1 的个数不变，就行不变。
列混合：

![[Pasted image 20220713161853.png]]
![[Pasted image 20220713162312.png]]
![[Pasted image 20220713162440.png]]

列混合过程是对状态矩阵的每一列左乘一个确定的矩阵(如下图)
![[Pasted image 20220713194309.png]]
行移位的 1 的个数不会发生变化，则奇偶性不会发生变化。
列混合不改变奇偶性的原因：每一列的和都是奇数(7)，奇数个亦或操作仍然等于自身，则
$$
	7a_0 \oplus 7a_1 \oplus 7a_2 \oplus 7a_3 = a_0 \oplus a_1 \oplus a_2 \oplus a_3
$$
则就行不发生改变。