## 并发编程

### Context

ThreadLocal ---> Context

新建的

赋值，新建的东西，线程 threadlocal 的东西。

rpc attachment  
grpc http header  
自定义的 rpc metadata

进程内传递  

context.Context 公共的方法

ekit 工具类库

长远考虑，提前使用 context.Context

![[Snipaste/Pasted image 20240127165501.png]]

child 覆盖 parent

![[Snipaste/Pasted image 20240127165737.png]]

传递一个 map，逼不得已，将 map 传递下去，child 修改 map，parent 可以拿到 map[key]

refresh token

![[Snipaste/Pasted image 20240127180248.png]]

判断是否超时  
![[Snipaste/Pasted image 20240127180415.png]]

正常的业务逻辑

- 超时分支
- 正常业务分支

没办法修改 Context

只能新建一个 Context

不建议在结构体中使用 context

errGroup ---> WaitGroup
