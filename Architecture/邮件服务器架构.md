#email #chatgpt  
电子邮件系统是互联网的基石，它在安全认证、个人社交、日常工作中发挥着关键作用。了解电子邮件系统的架构有助于理解整个互联网体系的顶层规划和运行逻辑。

电子邮件系统的历史可以追溯到早期的计算机网络时代。最早的电子邮件系统是在麻省理工学院开发的 MailBox，用于同一主机上的用户之间的沟通。随着互联网的发展，阿帕网（ARPANET）成为了第一个跨主机的网络，为电子邮件的跨主机传输提供了基础。

在阿帕网的基础上，Ray Tomlinson 博士设计了电子邮件的传输服务协议，并在 1971 年发送了人类历史上第一封电子邮件，从而诞生了电子邮件系统。

电子邮件系统的整体架构包括以下组件：

1. MailBox：邮件存储的地方，可以是 mbox 格式或 Maildir 格式，存储在操作系统的特定目录下。
2. MUA（Mail User Agent）：邮件客户端，用于接收和发送邮件，例如 Foxmail 或 Outlook。
3. MTA（Mail Transfer Agent）：通过 SMTP 协议发送和转发邮件的邮件传输代理，例如 sendmail 和 postfix。
4. MDA（Mail Delivery Agent）：将 MTA 接收到的邮件保存到磁盘或指定位置的邮件投递代理。
5. MRA（Mail Retrieval Agent）：负责实现 IMAP 和 POP3 协议，与 MUA 进行交互，例如 dovecot。

邮件系统使用的协议包括：

- SMTP（Simple Mail Transfer Protocol）：用于发送邮件的标准协议，常用的端口是 25、465（使用 SSL/TLS 协议）和 587（使用 STARTTLS 协议）。
- IMAP（Internet Message Access Protocol）：用于接收邮件的标准协议之一，常用的端口是 143、993（使用 SSL/TLS 协议）。
- POP3（Post Office Protocol 3）：用于接收邮件的标准协议之一，常用的端口是 110、995（使用 SSL 协议）。

邮件的发送和接收流程如下：

1. 发送方 MUA 使用 SMTP 协议将邮件发送给发送方 MTA。
2. 发送方 MTA 查询接收方邮件域名的 DNS MX 记录，获取接收方 MTA 的 IP 地址。
3. 发送方 MTA 使用 SMTP 协议将邮件发送给接收方 MTA。
4. 接收方 MTA 将邮件交给 MDA 进行投递。
5. MDA 将邮件存储到接收方主机的 MailBox 文件中。
6. 接收方 MUA 使用 IMAP 或 POP3

## Reference

- [详解电子邮件系统系列之一：整体架构 - 简书 (jianshu.com)](https://www.jianshu.com/p/98b85ae37465)
