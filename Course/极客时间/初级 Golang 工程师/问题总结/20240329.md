咨询一下腾讯面试的情况~

- [[../09 榜单模型与分布式任务调度之榜单模型|09 榜单模型与分布式任务调度之榜单模型]]

1. 害怕害怕，都开始评估了。

- [[../09 榜单模型与分布式任务调度之榜单模型|09 榜单模型与分布式任务调度之榜单模型]]
- 什么样的才算是热点？
- 如何计算热点？
- 热点必然带来高并发，那么怎么保证性能？
- 如果热点功能崩溃了，怎么样降低对整个系统的影响？

1. Hacknews：得票数最重要，而后热度随着事件衰减
2. Reddit 模型：赞成票、反对票和发帖事件

- 实时计算的难点：实时计算难点：全表扫描 + 全局排序
- 解决方案：异步定时计算、定时计算的时间可能很长 | 不能阻塞业务

1. 怎么设计缓存，保证极好的查询性能
2. 怎样保证可用性，任何情况下都能拿到热榜数据
3. context + ticker 的解决方案
4. 更加常用的办法 使用 cron 控制不同的时间间隔
5. @every duration @every 1s 1m30s
6. 小顶堆维护前 100 的文章
7. 最终结果放进 Redis 里面
	1. 热榜数据不会存放到数据库中，可以存放到数据库中方便大数据分析
	2. 过期时间 > 计算的间隔时间 + 留够重试的时间
8. 一个层级 job grpc web
9. job 不属于 DDD 的概念
10. job 是对外暴露的方式
11. 封装定时任务
12. 定时任务的机制
13. cronjob 是重要的
14. 整个榜单依赖于数据库和 Redis 的可用性
	1. MySQL 崩溃了，没有办法更新榜单了。
	2. 如果本地缓存也失败了，那么查询接口就会失效
15. 解决的方法是本地缓存设置兜底方案。Redis 崩溃的时候，再次尝试从本地花奴才能获取。此时不会检查本地缓存是否已经过期。
16. 正常的流程
	1. 先从本地缓存中获取，获取不到就去 Redis 获取
	2. 如果 Redis 崩溃了，再次尝试从本地缓存中获取，此时不会检查本地缓存的过期时间。
	3. 本地缓存方案实现起来是不难的
	4. failover 策略，告诉前端加载不到热榜数据的时候，重新发送一个请求，除非所有服务节点的本地缓存都失效了。
17. Redis 永不过期，可以规避数据库崩溃引发的榜单问题。
- 定时任务
- 文章发表 同步问题
- 点赞逻辑
- Elasticsearch 搜索
