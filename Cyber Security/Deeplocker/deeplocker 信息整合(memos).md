#deeplocker #memos  
需求： 1. 模型框架要使用 tensorflow 2. 模型的保存 tf.saved_model.save(conv_net, "./path2model")

- [ ] 需要对安装过程进行思考

## 近期规划

#deeplocker #规划  
deeplocker 近期规划

1. 找到 MTCNN-GO 的代码，并把它跑起来
2. 接口设计完成
3. 整体跑起来，但是代码的结构需要设计一下 (为了扩展性)
4. 下周做 APP 的开发，大下周完成进程注入的工作  
总体：
5. 第一周 (20230516) 完成预处理 + 整体流程 windows
6. 第二周完成生成 loader 的程序 (界面 + 大概流程)，先不要考虑细节 (比如进度条) —— 开发的任务比较重捏
7. 第三周完成进程注入的工作  
第一周工作规划：
8. 12 完整接口的设计工作，然后形成一张整体的设计图。可能要考虑配置的问题等等。
9. 剩下五天时间进行开发  
周六解决 ArcFace 的问题  
周天解决 KeyGen 的问题  
然后就完成了啊，还是不叫简单的。

```shell
go build  -ldflags "-extldflags '-static' -s -w -H windowsgui" .
```

问题：

- [ ] shellcode 的形式问题
- [x] 静态编译的问题
- [x] golang 泛型编程 + 面向接口编程
- [x] 我记得 golang 有一个泛型的库，比如什么是可计算类型的泛型定义
- [x] 解决黑色窗口的问题
- [x] 但是有些配置必须硬编码在代码里面，不能从外面加载
- [ ] 那就是以压缩包的形式安装
- [ ] 如果摄像头获取的图像里面有多张人脸应该怎么办
- [ ] 深度学习模型的代码需要看明白捏
- [x] 绝对路径和相对路径的问题
- [x] 动态链接库的问题
- [x] mtcnn 学习
- [x] 嵌入静态文件 go embed
- [x] 什么是 base，有什么用呢？
- [ ] 讨论一下源码
- [ ] 如果有可能，自己实现一套深度学习模型 (basic 就可以)
- [x] 将 gocv 和 mtcnn 连接上
- [x] 整体架构完成，明天解决 ArcFace
- [x] 找到预处理的代码并理解
- [x] 下一步是将预处理的代码翻译成 go 语言，然后传入 arcface 和 keygeneration ✅ 2023-06-04
- [x] [[../../Coding/Go/其他问题/绝对路径和相对路径问题|绝对路径和相对路径问题]] ✅ 2023-06-04

## 带有摄像头的软件收集

通常情况下，带有摄像头的应用程序是指具有拍照或录像功能的应用程序。例如，社交媒体应用程序如 Instagram、Snapchat、TikTok 等通常会使用摄像头进行拍照或录制短视频。另外，视频聊天应用程序如 Skype、Zoom 等也需要访问摄像头。一些游戏应用程序也可能需要访问摄像头，例如虚拟现实游戏。此外，一些智能家居应用程序，如智能门铃应用程序，也需要访问摄像头。总之，任何需要使用摄像头的应用程序都需要获取用户的授权才能访问摄像头。

**但是这些软件包含麦克风采集声音嘛**

## 对于 Deeplocker 组会的总结

这周的任务：

1. 总结一个会议纪要
2. 前端 UI 设计 (简约设计，考虑扩展性)：需要有上传图*片训练模型的功能
3. 前端指导后端 (需求指导编码)
4. 调研开源 APP，最好有摄像头功能 (考虑获取用户摄像头权限为题，尤其是 Android)  
整体的操作流程：
5. 选择目标 (上传目标图片，目标声音等信息)，进行相关配置如什么场景等等 (扩展内容)
6. 选择载荷 (目前是 msf 生成的载荷，提供可供选择的载荷)
7. 后端训练模型 (按钮等操作) ---> 为用户提示一些 Log 信息以及最终展示结果如“模型生成的密钥 (激活向量)“。当然要进行一些后端的配置，如多久采集一次摄像头图像。
8. 后端将加载器 (内包含载荷) 和模型放到同一文件夹下
9. 后端与指定 APP 进行捆绑 (这部分需要是可扩展的，后续可能有多个 APP)
10. 将生成的”APP“放到攻击机上 (实际可能通过社工等方法实现，目前不考虑传播问题)
11. 根据特定的目标载荷成功释放就 ok(条件判断暂不考虑逆向问题)  
需要考虑的问题：
12. 场景条件的判断 (在什么特定的场景下进行判断)
13. 摄像头权限问题 (尤其考虑 Android)
14. 模型的合并问题
15. 细细考虑有很多问题捏
16. 暂时先不考虑隐蔽性

## 整体设计

#deeplocker  
关于数据集

- BioID 和 LFW 数据集，CASIA-Webface。
- mtcnn
- 人脸识别模型的输入就是人脸数据集里的人脸图片，输出是相应的 512 维的向量。密钥生成模型的输入是 512 维的人脸向量，输出是 512 维的密钥
- [ ] 今天要把代码的结构好好设计一下

### 模块的职责

1. model 加载模型的底层功能 (需要重构)
2. monitor 应该单独抽象出来
3. tmplate 由两部分组成，一部分是真实程序 (开发的时候)，另一部分是由其创建的模板。需要给每个模板起个名字。
4. encrypt 各种加解密算法的实现：如 AES
5. config 加载配置文件，Config 模块需要扩展
6. utils 模块：基本通用模块
7. build 通过 template 和 config 模块构造  
今天先想好各个模块的功能还有哪些函数，明天开始重构项目。  
问题是判断标准出现在代码里面逆向的时候如果检测出来，安全人员会直接进行判断，然后解码出病毒样本。所以不能用明文去做判断条件：
8. AES 密钥最长是 256 bit  
图像预处理的代码需要 go 实现

## 模型所用框架和保存的需求

需求：

1. 模型框架要使用 tensorflow
2. 模型的保存 tf.saved_model.save(conv_net, "./path2model")  

查看模型的输入和输出

```shell
saved_model_cli.exe show --all --dir C:\Users\zhang\workspace\packvirus\src\model\models\KeyGenModel 
```

## 存在问题

- [[存在问题]]
