HIDS 架构基于 Server-Agent 模式，agent 在受监控的端点上运行，采集数据转发到服务端server，agent 与 server 之间的通信是通过 AES 加密后传输；server对传入的信息进行解码和分析，并将结果传递给 ES 进行索引和存储；ES 集群是一个或多个节点的集合，这些节点相互通信以对索引执行读写操作；

agent - server通信：代理与服务器服务建立连接以进行代理连接，默认情况下监听端口 1514（可配置），HIDS 消息协议默认使用 AES 加密，每个块 128 位和 256 位密钥。

server - es 通信： HIDS 服务器使用 Filebeat 将警报和事件数据发送到 HIDS 索引器，使用 TLS 加密。Filebeat 读取 HIDS 服务器输出数据并将其发送到 ES（默认监听端口 9200/TCP）。然后告警关联模块就可以通过 ES 的 RESTful API 访问告警数据，然后对告警数据进行关联。

Agent：Agent支持多平台部署，可部署在电脑、台式机、服务器、云实例或虚拟机等端点上。它们提供威胁预防、检测和响应功能。Agent具有模块化架构，其中不同组件负责各自的任务：监视文件系统，读取日志消息，收集清单数据，扫描系统配置，查找恶意软件等，用户可以通过配置启用或禁用代理模块设置。



# Reference
- [开源HIDS之Wazuh探究 | L0n9w4y](https://l0n9w4y.cc/posts/22306/#0x01-%E5%9F%BA%E7%A1%80%E7%AE%80%E4%BB%8B)
